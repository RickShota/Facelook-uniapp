{"version":3,"sources":["uni-app:///main.js","webpack:///E:/Project/socialgo-uniapp/pages/add-input/add-input.vue?ff0d","webpack:///E:/Project/socialgo-uniapp/pages/add-input/add-input.vue?e02e","webpack:///E:/Project/socialgo-uniapp/pages/add-input/add-input.vue?97ac","webpack:///E:/Project/socialgo-uniapp/pages/add-input/add-input.vue?d5fa","uni-app:///pages/add-input/add-input.vue","webpack:///E:/Project/socialgo-uniapp/uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue?8db2","webpack:///E:/Project/socialgo-uniapp/uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue?ac52","webpack:///E:/Project/socialgo-uniapp/uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue?54f3","webpack:///E:/Project/socialgo-uniapp/uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue?ee29","uni-app:///uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue","webpack:///E:/Project/socialgo-uniapp/uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue?4997","webpack:///E:/Project/socialgo-uniapp/pages/add-input/add-input.vue?166c"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniNavBar","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped"],"mappings":"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","file":"pages/add-input/add-input.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/add-input/add-input.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./add-input.vue?vue&type=template&id=2796b904&scoped=true&\"\nvar renderjs\nimport script from \"./add-input.vue?vue&type=script&lang=js&\"\nexport * from \"./add-input.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add-input.vue?vue&type=style&index=0&id=2796b904&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2796b904\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/add-input/add-input.vue\"\nexport default component.exports","export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add-input.vue?vue&type=template&id=2796b904&scoped=true&\"","var components\ntry {\n  components = {\n    uniNavBar: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar\" */ \"@/uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add-input.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add-input.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<!-- 自定义导航栏组件 -->\r\n\t\t<uni-nav-bar statusBar @clickLeft=\"goback\" backgroundColor=\"#f0f2f5\" left-icon=\"closeempty\"\r\n\t\t\tfixed=\"true\" title=\"创建帖子\">\r\n\t\t</uni-nav-bar>\r\n\t\t<!-- #ifdef MP-WEIXIN -->\r\n\t\t<view style=\"padding: 40rpx;\">\r\n\t\t\t<empty-page text1=\"出错啦\" text2=\"该模块由于涉及个人主体小程序未开放类目，其用户输入功能已剔除，无法正常展示，App-Plus和H5端正常展示\"></empty-page>\r\n\t\t</view>\r\n\t\t<!-- #endif -->\r\n\t\t<!-- #ifndef MP-WEIXIN -->\r\n\t\t<view style=\"padding: 20rpx;\">\r\n\t\t\t<!-- 用户信息 -->\r\n\t\t\t<view class=\"userInfo\">\r\n\t\t\t\t<view style=\"display: flex;align-items: center;\">\r\n\t\t\t\t\t<!-- 头像 -->\r\n\t\t\t\t\t<image class=\"rounded-circle mr-2\" src=\"/static/default/userImg.jpg\" />\r\n\t\t\t\t\t<!-- 昵称 -->\r\n\t\t\t\t\t<view>\r\n\t\t\t\t\t\t<view class=\"name\">Rick Henry</view>\r\n\t\t\t\t\t\t<text class=\"font-small text-light-muted\">#所有人</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- 发布按钮 -->\r\n\t\t\t\t\t<view class=\"send-btn\" @click=\"send\">发布</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 输入框 -->\r\n\t\t\t<textarea class=\"editBox\" placeholder=\"分享一下你的新鲜事吧\" v-model=\"text\"></textarea>\r\n\t\t\t<!-- 第三方插件：图片选择器 -->\r\n\t\t\t<uni-file-picker v-show=\"imageList.length>0\" ref=\"choosePic\" v-model=\"imageList\" fileMediatype=\"image\"\r\n\t\t\t\tmode=\"grid\" @select=\"select\" @progress=\"progress\" @success=\"success\" @fail=\"fail\" />\r\n\t\t</view>\r\n\t\t<!-- #endif -->\r\n\t\t<!-- 底部操作条 -->\r\n\t\t<view class=\"bottomBar\">\r\n\t\t\t<view class=\"iconfont icon-tuwenxiangqing\" @click=\"checkImg\"></view>\r\n\t\t\t<view class=\"iconfont icon-biaoqian\"></view>\r\n\t\t\t<view class=\"iconfont icon-xiaolian1\"></view>\r\n\t\t\t<view class=\"iconfont icon-dingwei1\" @click=\"checkLocation\"></view>\r\n\t\t\t<view class=\"iconfont icon-jianpan\" @click=\"checkKeyboard\"></view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport uniNavBar from '@/uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.vue'\r\n\timport uniFilePicker from '@/uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue'\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tuniNavBar\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttext: '',\r\n\t\t\t\timageList: [], // 图片缓存地址\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 页面启动时钩子函数\r\n\t\tonLaunch() {\r\n\r\n\t\t},\r\n\t\t// 页面加载时钩子函数\r\n\t\tonLoad() {\r\n\t\t\t// 还原草稿\r\n\t\t\tuni.getStorage({\r\n\t\t\t\tkey: 'add-input',\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.data) { // 如果有值\r\n\t\t\t\t\t\tlet result = JSON.parse(res.data)\r\n\t\t\t\t\t\tthis.text = result.content\r\n\t\t\t\t\t\tthis.imageList = result.imageList\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// #ifdef APP || H5\r\n\t\t\t// 获取上传状态\r\n\t\t\tselect(e) {\r\n\t\t\t\tconsole.log('选择文件：', e)\r\n\t\t\t},\r\n\t\t\t// 获取上传进度\r\n\t\t\tprogress(e) {\r\n\t\t\t\tconsole.log('上传进度：', e)\r\n\t\t\t},\r\n\t\t\t// 上传成功\r\n\t\t\tsuccess(e) {\r\n\t\t\t\tconsole.log('上传成功')\r\n\t\t\t},\r\n\t\t\t// 上传失败\r\n\t\t\tfail(e) {\r\n\t\t\t\tconsole.log('上传失败：', e)\r\n\t\t\t},\r\n\t\t\t// 返回按钮\r\n\t\t\tgoback() {\r\n\t\t\t\t// 保存草稿功能\r\n\t\t\t\t// #ifdef APP || APP-PLUS\r\n\t\t\t\tif (this.text !== '' || this.imageList.length > 0) {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: '是否保存为草稿？',\r\n\t\t\t\t\t\tshowCancel: true,\r\n\t\t\t\t\t\tcancelText: '不保存',\r\n\t\t\t\t\t\tconfirmText: '保存',\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\tthis.saveStore() // 存\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// 返回上页\r\n\t\t\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\t\t\tanimationType: 'slide-out-bottom' // 返回动画：从底部滑出\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t// 清楚缓存\r\n\t\t\t\t\t\t\t\tuni.removeStorage({\r\n\t\t\t\t\t\t\t\t\tkey: \"add-input\"\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\tanimationType: 'slide-out-bottom'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef MP-WEIXIN || H5\r\n\t\t\t\t// 返回上页\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdata:1,\r\n\t\t\t\t\tanimationType: 'slide-out-bottom' // 返回动画：从底部滑出\r\n\t\t\t\t})\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\t// 发送按钮\r\n\t\t\tsend() {\r\n\t\t\t\tconsole.log(\"发送内容：\", this.text, this.imageList);\r\n\t\t\t},\r\n\t\t\t// 保存草稿\r\n\t\t\tsaveStore() {\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tcontent: this.text,\r\n\t\t\t\t\timageList: this.imageList\r\n\t\t\t\t}\r\n\t\t\t\tuni.setStorage({\r\n\t\t\t\t\tkey: 'add-input',\r\n\t\t\t\t\tdata: JSON.stringify(obj)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcheckImg() {\r\n\t\t\t\t// 调用uni-file-picker组件内部的选图片方法\r\n\t\t\t\tthis.$refs.choosePic.choose();\r\n\t\t\t},\r\n\t\t\tcheckLocation() {\r\n\t\t\t\tuni.getLocation({\r\n\t\t\t\t\ttype: 'wgs84',\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tconsole.log('当前位置的经度：' + res.longitude);\r\n\t\t\t\t\t\tconsole.log('当前位置的纬度：' + res.latitude);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\tcheckKeyboard() {\r\n\t\t\t\tuni.hideKeyboard()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.editBox {\r\n\t\twidth: 100%;\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\r\n\t.userInfo {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\r\n\t\timage {\r\n\t\t\twidth: 75rpx;\r\n\t\t\theight: 75rpx;\r\n\t\t}\r\n\r\n\t\t.name {\r\n\t\t\tfont-size: 25rpx;\r\n\t\t\tline-height: 0.5;\r\n\t\t}\r\n\r\n\t\ttext {\r\n\t\t\tcolor: #9d9589;\r\n\t\t\tline-height: 0.5;\r\n\t\t}\r\n\t\t.send-btn{\r\n\t\t\tbackground-color: #1676f1;\r\n\t\t\tcolor: #fff;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tpadding: 10rpx 20rpx;\r\n\t\t\tborder-radius: 10rpx;\r\n\t\t\tposition: fixed;\r\n\t\t\tright: 30rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.bottomBar {\r\n\t\theight: 100rpx;\r\n\t\twidth: 100%;\r\n\t\tbox-shadow: 2px 2px 5px 3px #c5c5c5;\r\n\t\tborder-radius: 30rpx 30rpx 0 0;\r\n\t\tposition: fixed;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-evenly;\r\n\t\tbottom: 0;\r\n\r\n\t\tview {\r\n\t\t\tflex: 1;\r\n\t\t\ttext-align: center;\r\n\t\t\tfont-size: 55rpx;\r\n\r\n\t\t\t&:nth-child(1) {\r\n\t\t\t\tcolor: #55aa00;\r\n\t\t\t}\r\n\r\n\t\t\t&:nth-child(2) {\r\n\t\t\t\tcolor: #0051ff;\r\n\t\t\t}\r\n\r\n\t\t\t&:nth-child(3) {\r\n\t\t\t\tcolor: #ffc800;\r\n\t\t\t}\r\n\r\n\t\t\t&:nth-child(4) {\r\n\t\t\t\tcolor: #e60000;\r\n\t\t\t}\r\n\r\n\t\t\t&:nth-child(5) {\r\n\t\t\t\tcolor: #585858;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>\n","import { render, staticRenderFns, recyclableRender, components } from \"./uni-file-picker.vue?vue&type=template&id=363ace0e&\"\nvar renderjs\nimport script from \"./uni-file-picker.vue?vue&type=script&lang=js&\"\nexport * from \"./uni-file-picker.vue?vue&type=script&lang=js&\"\nimport style0 from \"./uni-file-picker.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue\"\nexport default component.exports","export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./uni-file-picker.vue?vue&type=template&id=363ace0e&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./uni-file-picker.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./uni-file-picker.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"uni-file-picker\">\r\n\t\t<view v-if=\"title\" class=\"uni-file-picker__header\">\r\n\t\t\t<text class=\"file-title\">{{ title }}</text>\r\n\t\t\t<text class=\"file-count\">{{ filesList.length }}/{{ limitLength }}</text>\r\n\t\t</view>\r\n\t\t<upload-image v-if=\"fileMediatype === 'image' && showType === 'grid'\" :readonly=\"readonly\"\r\n\t\t\t:image-styles=\"imageStyles\" :files-list=\"filesList\" :limit=\"limitLength\" :disablePreview=\"disablePreview\"\r\n\t\t\t:delIcon=\"delIcon\" @uploadFiles=\"uploadFiles\" @choose=\"choose\" @delFile=\"delFile\">\r\n\t\t\t<slot>\r\n\t\t\t\t<view class=\"is-add\">\r\n\t\t\t\t\t<view class=\"icon-add\"></view>\r\n\t\t\t\t\t<view class=\"icon-add rotate\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t</slot>\r\n\t\t</upload-image>\r\n\t\t<upload-file v-if=\"fileMediatype !== 'image' || showType !== 'grid'\" :readonly=\"readonly\"\r\n\t\t\t:list-styles=\"listStyles\" :files-list=\"filesList\" :showType=\"showType\" :delIcon=\"delIcon\"\r\n\t\t\t@uploadFiles=\"uploadFiles\" @choose=\"choose\" @delFile=\"delFile\">\r\n\t\t\t<slot><button type=\"primary\" size=\"mini\">选择文件</button></slot>\r\n\t\t</upload-file>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tchooseAndUploadFile,\r\n\t\tuploadCloudFiles\r\n\t} from './choose-and-upload-file.js'\r\n\timport {\r\n\t\tget_file_ext,\r\n\t\tget_extname,\r\n\t\tget_files_and_is_max,\r\n\t\tget_file_info,\r\n\t\tget_file_data\r\n\t} from './utils.js'\r\n\timport uploadImage from './upload-image.vue'\r\n\timport uploadFile from './upload-file.vue'\r\n\tlet fileInput = null\r\n\t/**\r\n\t * FilePicker 文件选择上传\r\n\t * @description 文件选择上传组件，可以选择图片、视频等任意文件并上传到当前绑定的服务空间\r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?id=4079\r\n\t * @property {Object|Array}\tvalue\t组件数据，通常用来回显 ,类型由return-type属性决定\r\n\t * @property {Boolean}\tdisabled = [true|false]\t组件禁用\r\n\t * \t@value true \t禁用\r\n\t * \t@value false \t取消禁用\r\n\t * @property {Boolean}\treadonly = [true|false]\t组件只读，不可选择，不显示进度，不显示删除按钮\r\n\t * \t@value true \t只读\r\n\t * \t@value false \t取消只读\r\n\t * @property {String}\treturn-type = [array|object]\t限制 value 格式，当为 object 时 ，组件只能单选，且会覆盖\r\n\t * \t@value array\t规定 value 属性的类型为数组\r\n\t * \t@value object\t规定 value 属性的类型为对象\r\n\t * @property {Boolean}\tdisable-preview = [true|false]\t禁用图片预览，仅 mode:grid 时生效\r\n\t * \t@value true \t禁用图片预览\r\n\t * \t@value false \t取消禁用图片预览\r\n\t * @property {Boolean}\tdel-icon = [true|false]\t是否显示删除按钮\r\n\t * \t@value true \t显示删除按钮\r\n\t * \t@value false \t不显示删除按钮\r\n\t * @property {Boolean}\tauto-upload = [true|false]\t是否自动上传，值为true则只触发@select,可自行上传\r\n\t * \t@value true \t自动上传\r\n\t * \t@value false \t取消自动上传\r\n\t * @property {Number|String}\tlimit\t最大选择个数 ，h5 会自动忽略多选的部分\r\n\t * @property {String}\ttitle\t组件标题，右侧显示上传计数\r\n\t * @property {String}\tmode = [list|grid]\t选择文件后的文件列表样式\r\n\t * \t@value list \t列表显示\r\n\t * \t@value grid \t宫格显示\r\n\t * @property {String}\tfile-mediatype = [image|video|all]\t选择文件类型\r\n\t * \t@value image\t只选择图片\r\n\t * \t@value video\t只选择视频\r\n\t * \t@value all\t\t选择所有文件\r\n\t * @property {Array}\tfile-extname\t选择文件后缀，根据 file-mediatype 属性而不同\r\n\t * @property {Object}\tlist-style\tmode:list 时的样式\r\n\t * @property {Object}\timage-styles\t选择文件后缀，根据 file-mediatype 属性而不同\r\n\t * @event {Function} select \t选择文件后触发\r\n\t * @event {Function} progress 文件上传时触发\r\n\t * @event {Function} success \t上传成功触发\r\n\t * @event {Function} fail \t\t上传失败触发\r\n\t * @event {Function} delete \t文件从列表移除时触发\r\n\t */\r\n\texport default {\r\n\t\tname: 'uniFilePicker',\r\n\t\tcomponents: {\r\n\t\t\tuploadImage,\r\n\t\t\tuploadFile\r\n\t\t},\r\n\t\toptions: {\r\n\t\t\tvirtualHost: true\r\n\t\t},\r\n\t\temits: ['select', 'success', 'fail', 'progress', 'delete', 'update:modelValue', 'input'],\r\n\t\tprops: {\r\n\t\t\t// #ifdef VUE3\r\n\t\t\tmodelValue: {\r\n\t\t\t\ttype: [Array, Object],\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifndef VUE3\r\n\t\t\tvalue: {\r\n\t\t\t\ttype: [Array, Object],\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\r\n\t\t\tdisabled: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\tdisablePreview: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\tdelIcon: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\t// 自动上传\r\n\t\t\tautoUpload: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\t// 最大选择个数 ，h5只能限制单选或是多选\r\n\t\t\tlimit: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 9\r\n\t\t\t},\r\n\t\t\t// 列表样式 grid | list | list-card\r\n\t\t\tmode: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'grid'\r\n\t\t\t},\r\n\t\t\t// 选择文件类型  image/video/all\r\n\t\t\tfileMediatype: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'image'\r\n\t\t\t},\r\n\t\t\t// 文件类型筛选\r\n\t\t\tfileExtname: {\r\n\t\t\t\ttype: [Array, String],\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttitle: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\tlistStyles: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t// 是否显示边框\r\n\t\t\t\t\t\tborder: true,\r\n\t\t\t\t\t\t// 是否显示分隔线\r\n\t\t\t\t\t\tdividline: true,\r\n\t\t\t\t\t\t// 线条样式\r\n\t\t\t\t\t\tborderStyle: {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\timageStyles: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\twidth: 'auto',\r\n\t\t\t\t\t\theight: 'auto'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\treadonly: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\treturnType: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'array'\r\n\t\t\t},\r\n\t\t\tsizeType: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn ['original', 'compressed']\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tfiles: [],\r\n\t\t\t\tlocalValue: []\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\t// #ifndef VUE3\r\n\t\t\tvalue: {\r\n\t\t\t\thandler(newVal, oldVal) {\r\n\t\t\t\t\tthis.setValue(newVal, oldVal)\r\n\t\t\t\t},\r\n\t\t\t\timmediate: true\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\t// #ifdef VUE3\r\n\t\t\tmodelValue: {\r\n\t\t\t\thandler(newVal, oldVal) {\r\n\t\t\t\t\tthis.setValue(newVal, oldVal)\r\n\t\t\t\t},\r\n\t\t\t\timmediate: true\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tfilesList() {\r\n\t\t\t\tlet files = []\r\n\t\t\t\tthis.files.forEach(v => {\r\n\t\t\t\t\tfiles.push(v)\r\n\t\t\t\t})\r\n\t\t\t\treturn files\r\n\t\t\t},\r\n\t\t\tshowType() {\r\n\t\t\t\tif (this.fileMediatype === 'image') {\r\n\t\t\t\t\treturn this.mode\r\n\t\t\t\t}\r\n\t\t\t\treturn 'list'\r\n\t\t\t},\r\n\t\t\tlimitLength() {\r\n\t\t\t\tif (this.returnType === 'object') {\r\n\t\t\t\t\treturn 1\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.limit) {\r\n\t\t\t\t\treturn 1\r\n\t\t\t\t}\r\n\t\t\t\tif (this.limit >= 9) {\r\n\t\t\t\t\treturn 9\r\n\t\t\t\t}\r\n\t\t\t\treturn this.limit\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t// TODO 兼容不开通服务空间的情况\r\n\t\t\tif (!(uniCloud.config && uniCloud.config.provider)) {\r\n\t\t\t\tthis.noSpace = true\r\n\t\t\t\tuniCloud.chooseAndUploadFile = chooseAndUploadFile\r\n\t\t\t}\r\n\t\t\tthis.form = this.getForm('uniForms')\r\n\t\t\tthis.formItem = this.getForm('uniFormsItem')\r\n\t\t\tif (this.form && this.formItem) {\r\n\t\t\t\tif (this.formItem.name) {\r\n\t\t\t\t\tthis.rename = this.formItem.name\r\n\t\t\t\t\tthis.form.inputChildrens.push(this)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * 公开用户使用，清空文件\r\n\t\t\t * @param {Object} index\r\n\t\t\t */\r\n\t\t\tclearFiles(index) {\r\n\t\t\t\tif (index !== 0 && !index) {\r\n\t\t\t\t\tthis.files = []\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tthis.setEmit()\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.files.splice(index, 1)\r\n\t\t\t\t}\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.setEmit()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 公开用户使用，继续上传\r\n\t\t\t */\r\n\t\t\tupload() {\r\n\t\t\t\tlet files = []\r\n\t\t\t\tthis.files.forEach((v, index) => {\r\n\t\t\t\t\tif (v.status === 'ready' || v.status === 'error') {\r\n\t\t\t\t\t\tfiles.push(Object.assign({}, v))\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\treturn this.uploadFiles(files)\r\n\t\t\t},\r\n\t\t\tasync setValue(newVal, oldVal) {\r\n\t\t\t\tconst newData =  async (v) => {\r\n\t\t\t\t\tconst reg = /cloud:\\/\\/([\\w.]+\\/?)\\S*/\r\n\t\t\t\t\tlet url = ''\r\n\t\t\t\t\tif(v.fileID){\r\n\t\t\t\t\t\turl = v.fileID\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\turl = v.url\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (reg.test(url)) {\r\n\t\t\t\t\t\tv.fileID = url\r\n\t\t\t\t\t\tv.url = await this.getTempFileURL(url)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(v.url) v.path = v.url\r\n\t\t\t\t\treturn v\r\n\t\t\t\t}\r\n\t\t\t\tif (this.returnType === 'object') {\r\n\t\t\t\t\tif (newVal) {\r\n\t\t\t\t\t\tawait newData(newVal)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewVal = {}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!newVal) newVal = []\r\n\t\t\t\t\tfor(let i =0 ;i < newVal.length ;i++){\r\n\t\t\t\t\t\tlet v = newVal[i]\r\n\t\t\t\t\t\tawait newData(v)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.localValue = newVal\r\n\t\t\t\tif (this.form && this.formItem &&!this.is_reset) {\r\n\t\t\t\t\tthis.is_reset = false\r\n\t\t\t\t\tthis.formItem.setValue(this.localValue)\r\n\t\t\t\t}\r\n\t\t\t\tlet filesData = Object.keys(newVal).length > 0 ? newVal : [];\r\n\t\t\t\tthis.files = [].concat(filesData)\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 选择文件\r\n\t\t\t */\r\n\t\t\tchoose() {\r\n\t\t\t\t\r\n\t\t\t\tif (this.disabled) return\r\n\t\t\t\tif (this.files.length >= Number(this.limitLength) && this.showType !== 'grid' && this.returnType ===\r\n\t\t\t\t\t'array') {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `您最多选择 ${this.limitLength} 个文件`,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tthis.chooseFiles()\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 选择文件并上传\r\n\t\t\t */\r\n\t\t\tchooseFiles() {\r\n\t\t\t\tconst _extname = get_extname(this.fileExtname)\r\n\t\t\t\t// 获取后缀\r\n\t\t\t\tuniCloud\r\n\t\t\t\t\t.chooseAndUploadFile({\r\n\t\t\t\t\t\ttype: this.fileMediatype,\r\n\t\t\t\t\t\tcompressed: false,\r\n\t\t\t\t\t\tsizeType: this.sizeType,\r\n\t\t\t\t\t\t// TODO 如果为空，video 有问题\r\n\t\t\t\t\t\textension: _extname.length > 0 ? _extname : undefined,\r\n\t\t\t\t\t\tcount: this.limitLength - this.files.length, //默认9\r\n\t\t\t\t\t\tonChooseFile: this.chooseFileCallback,\r\n\t\t\t\t\t\tonUploadProgress: progressEvent => {\r\n\t\t\t\t\t\t\tthis.setProgress(progressEvent, progressEvent.index)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(result => {\r\n\t\t\t\t\t\tthis.setSuccessAndError(result.tempFiles)\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tconsole.log('选择失败', err)\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 选择文件回调\r\n\t\t\t * @param {Object} res\r\n\t\t\t */\r\n\t\t\tasync chooseFileCallback(res) {\r\n\t\t\t\tconst _extname = get_extname(this.fileExtname)\r\n\t\t\t\tconst is_one = (Number(this.limitLength) === 1 &&\r\n\t\t\t\t\t\tthis.disablePreview &&\r\n\t\t\t\t\t\t!this.disabled) ||\r\n\t\t\t\t\tthis.returnType === 'object'\r\n\t\t\t\t// 如果这有一个文件 ，需要清空本地缓存数据\r\n\t\t\t\tif (is_one) {\r\n\t\t\t\t\tthis.files = []\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet {\r\n\t\t\t\t\tfilePaths,\r\n\t\t\t\t\tfiles\r\n\t\t\t\t} = get_files_and_is_max(res, _extname)\r\n\t\t\t\tif (!(_extname && _extname.length > 0)) {\r\n\t\t\t\t\tfilePaths = res.tempFilePaths\r\n\t\t\t\t\tfiles = res.tempFiles\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet currentData = []\r\n\t\t\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\t\t\tif (this.limitLength - this.files.length <= 0) break\r\n\t\t\t\t\tfiles[i].uuid = Date.now()\r\n\t\t\t\t\tlet filedata = await get_file_data(files[i], this.fileMediatype)\r\n\t\t\t\t\tfiledata.progress = 0\r\n\t\t\t\t\tfiledata.status = 'ready'\r\n\t\t\t\t\tthis.files.push(filedata)\r\n\t\t\t\t\tcurrentData.push({\r\n\t\t\t\t\t\t...filedata,\r\n\t\t\t\t\t\tfile: files[i]\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tthis.$emit('select', {\r\n\t\t\t\t\ttempFiles: currentData,\r\n\t\t\t\t\ttempFilePaths: filePaths\r\n\t\t\t\t})\r\n\t\t\t\tres.tempFiles = files\r\n\t\t\t\t// 停止自动上传\r\n\t\t\t\tif (!this.autoUpload || this.noSpace) {\r\n\t\t\t\t\tres.tempFiles = []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 批传\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tuploadFiles(files) {\r\n\t\t\t\tfiles = [].concat(files)\r\n\t\t\t\treturn uploadCloudFiles.call(this, files, 5, res => {\r\n\t\t\t\t\t\tthis.setProgress(res, res.index, true)\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(result => {\r\n\t\t\t\t\t\tthis.setSuccessAndError(result)\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 成功或失败\r\n\t\t\t */\r\n\t\t\tasync setSuccessAndError(res, fn) {\r\n\t\t\t\tlet successData = []\r\n\t\t\t\tlet errorData = []\r\n\t\t\t\tlet tempFilePath = []\r\n\t\t\t\tlet errorTempFilePath = []\r\n\t\t\t\tfor (let i = 0; i < res.length; i++) {\r\n\t\t\t\t\tconst item = res[i]\r\n\t\t\t\t\tconst index = item.uuid ? this.files.findIndex(p => p.uuid === item.uuid) : item.index\r\n\r\n\t\t\t\t\tif (index === -1 || !this.files) break\r\n\t\t\t\t\tif (item.errMsg === 'request:fail') {\r\n\t\t\t\t\t\tthis.files[index].url = item.path\r\n\t\t\t\t\t\tthis.files[index].status = 'error'\r\n\t\t\t\t\t\tthis.files[index].errMsg = item.errMsg\r\n\t\t\t\t\t\t// this.files[index].progress = -1\r\n\t\t\t\t\t\terrorData.push(this.files[index])\r\n\t\t\t\t\t\terrorTempFilePath.push(this.files[index].url)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.files[index].errMsg = ''\r\n\t\t\t\t\t\tthis.files[index].fileID = item.url\r\n\t\t\t\t\t\tconst reg = /cloud:\\/\\/([\\w.]+\\/?)\\S*/\r\n\t\t\t\t\t\tif (reg.test(item.url)) {\r\n\t\t\t\t\t\t\tthis.files[index].url = await this.getTempFileURL(item.url)\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.files[index].url = item.url\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.files[index].status = 'success'\r\n\t\t\t\t\t\tthis.files[index].progress += 1\r\n\t\t\t\t\t\tsuccessData.push(this.files[index])\r\n\t\t\t\t\t\ttempFilePath.push(this.files[index].fileID)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (successData.length > 0) {\r\n\t\t\t\t\tthis.setEmit()\r\n\t\t\t\t\t// 状态改变返回\r\n\t\t\t\t\tthis.$emit('success', {\r\n\t\t\t\t\t\ttempFiles: this.backObject(successData),\r\n\t\t\t\t\t\ttempFilePaths: tempFilePath\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (errorData.length > 0) {\r\n\t\t\t\t\tthis.$emit('fail', {\r\n\t\t\t\t\t\ttempFiles: this.backObject(errorData),\r\n\t\t\t\t\t\ttempFilePaths: errorTempFilePath\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 获取进度\r\n\t\t\t * @param {Object} progressEvent\r\n\t\t\t * @param {Object} index\r\n\t\t\t * @param {Object} type\r\n\t\t\t */\r\n\t\t\tsetProgress(progressEvent, index, type) {\r\n\t\t\t\tconst fileLenth = this.files.length\r\n\t\t\t\tconst percentNum = (index / fileLenth) * 100\r\n\t\t\t\tconst percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total)\r\n\t\t\t\tlet idx = index\r\n\t\t\t\tif (!type) {\r\n\t\t\t\t\tidx = this.files.findIndex(p => p.uuid === progressEvent.tempFile.uuid)\r\n\t\t\t\t}\r\n\t\t\t\tif (idx === -1 || !this.files[idx]) return\r\n\t\t\t\t// fix by mehaotian 100 就会消失，-1 是为了让进度条消失\r\n\t\t\t\tthis.files[idx].progress = percentCompleted - 1\r\n\t\t\t\t// 上传中\r\n\t\t\t\tthis.$emit('progress', {\r\n\t\t\t\t\tindex: idx,\r\n\t\t\t\t\tprogress: parseInt(percentCompleted),\r\n\t\t\t\t\ttempFile: this.files[idx]\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 删除文件\r\n\t\t\t * @param {Object} index\r\n\t\t\t */\r\n\t\t\tdelFile(index) {\r\n\t\t\t\tthis.$emit('delete', {\r\n\t\t\t\t\ttempFile: this.files[index],\r\n\t\t\t\t\ttempFilePath: this.files[index].url\r\n\t\t\t\t})\r\n\t\t\t\tthis.files.splice(index, 1)\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.setEmit()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 获取文件名和后缀\r\n\t\t\t * @param {Object} name\r\n\t\t\t */\r\n\t\t\tgetFileExt(name) {\r\n\t\t\t\tconst last_len = name.lastIndexOf('.')\r\n\t\t\t\tconst len = name.length\r\n\t\t\t\treturn {\r\n\t\t\t\t\tname: name.substring(0, last_len),\r\n\t\t\t\t\text: name.substring(last_len + 1, len)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 处理返回事件\r\n\t\t\t */\r\n\t\t\tsetEmit() {\r\n\t\t\t\tlet data = []\r\n\t\t\t\tif (this.returnType === 'object') {\r\n\t\t\t\t\tdata = this.backObject(this.files)[0]\r\n\t\t\t\t\tthis.localValue = data?data:null\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata = this.backObject(this.files)\r\n\t\t\t\t\tif (!this.localValue) {\r\n\t\t\t\t\t\tthis.localValue = []\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.localValue = [...data]\r\n\t\t\t\t}\r\n\t\t\t\t// #ifdef VUE3\r\n\t\t\t\tthis.$emit('update:modelValue', this.localValue)\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef VUE3\r\n\t\t\t\tthis.$emit('input', this.localValue)\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 处理返回参数\r\n\t\t\t * @param {Object} files\r\n\t\t\t */\r\n\t\t\tbackObject(files) {\r\n\t\t\t\tlet newFilesData = []\r\n\t\t\t\tfiles.forEach(v => {\r\n\t\t\t\t\tnewFilesData.push({\r\n\t\t\t\t\t\textname: v.extname,\r\n\t\t\t\t\t\tfileType: v.fileType,\r\n\t\t\t\t\t\timage: v.image,\r\n\t\t\t\t\t\tname: v.name,\r\n\t\t\t\t\t\tpath: v.path,\r\n\t\t\t\t\t\tsize: v.size,\r\n\t\t\t\t\t\tfileID:v.fileID,\r\n\t\t\t\t\t\turl: v.url\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\treturn newFilesData\r\n\t\t\t},\r\n\t\t\tasync getTempFileURL(fileList) {\r\n\t\t\t\tfileList = {\r\n\t\t\t\t\tfileList: [].concat(fileList)\r\n\t\t\t\t}\r\n\t\t\t\tconst urls = await uniCloud.getTempFileURL(fileList)\r\n\t\t\t\treturn urls.fileList[0].tempFileURL || ''\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 获取父元素实例\r\n\t\t\t */\r\n\t\t\tgetForm(name = 'uniForms') {\r\n\t\t\t\tlet parent = this.$parent;\r\n\t\t\t\tlet parentName = parent.$options.name;\r\n\t\t\t\twhile (parentName !== name) {\r\n\t\t\t\t\tparent = parent.$parent;\r\n\t\t\t\t\tif (!parent) return false;\r\n\t\t\t\t\tparentName = parent.$options.name;\r\n\t\t\t\t}\r\n\t\t\t\treturn parent;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.uni-file-picker {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tbox-sizing: border-box;\r\n\t\toverflow: hidden;\r\n\t\twidth: 100%;\r\n\t\t/* #endif */\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.uni-file-picker__header {\r\n\t\tpadding-top: 5px;\r\n\t\tpadding-bottom: 10px;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.file-title {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.file-count {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.is-add {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.icon-add {\r\n\t\twidth: 50px;\r\n\t\theight: 5px;\r\n\t\tbackground-color: #f1f1f1;\r\n\t\tborder-radius: 2px;\r\n\t}\r\n\r\n\t.rotate {\r\n\t\tposition: absolute;\r\n\t\ttransform: rotate(90deg);\r\n\t}\r\n</style>\r\n","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./uni-file-picker.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./uni-file-picker.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--10-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--10-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\less-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-4!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-5!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add-input.vue?vue&type=style&index=0&id=2796b904&lang=less&scoped=true&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--10-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--10-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\less-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-4!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-5!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./add-input.vue?vue&type=style&index=0&id=2796b904&lang=less&scoped=true&\""],"sourceRoot":""}